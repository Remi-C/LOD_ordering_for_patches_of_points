# -*- coding: utf-8 -*-
"""
Created on Fri Dec 19 15:41:26 2014

@author: remi
"""
import numpy as np ;
import networkx as nx
from matplotlib import cm as cmap
labels = ['other ground', 'road', 'sidewalk', 'building', 'punctual object', 'pedestrian', '4+ wheelers']
labels = ['unclassified', 'other ground', 'road', 'sidewalk', 'curb', 'building', 'other object', 'post', 'floor lamp', 'traffic sign', 'mailbox', 'trash can', 'grid', 'pedestrian', 'other pedestrian', 'still pedestrian', 'holding pedestrian', 'bicycle', 'scooter', 'other 4+ wheels', 'tree', 'potted plant']

labels = ['unclassified', 'other ground', 'road', 'sidewalk', 'curb', 'building', 'other object', 'punctual object', 'linear', 'pedestrian', '2 wheelers', '4+ wheelers', 'tree', 'potted plant'] ; 

labels =  ['unclassified', 'ground', 'building', 'other object', 'static', 'Dynamic', 'natural'];


cm = np.array([[ 0.,0.33333333 ,0.33333333, 0.,0.,0.,0.33333333],
[ 0.03846154 ,0.84615385,0.11538462,0.,0.,0.,0. ],
[ 0.,0.07142857 ,0.89285714, 0.,0.,0.,0.03571429],
[ 0.,0.,0.01654846,0.93144208,0.03546099,0.00236407,0.0141844 ],
[ 0.,0.,0.,0.,1.,0.,0.        ],
[ 0.,0.,0.,1.,0.,0.,0.        ],
[ 0.15384615,0.,0.,0.07692308,0.23076923,0.,0.53846154]])

#confusion matrix for all class all feature
cm = np.array(
[[  1.25000000e-01,9.61538462e-03,3.84615385e-02,5.76923077e-02,1.92307692e-02,1.15384615e-01,1.73076923e-01,2.88461538e-02,4.80769231e-02,0.00000000e+00,0.00000000e+00,1.92307692e-02,7.69230769e-02,0.00000000e+00,9.61538462e-03,2.88461538e-02,0.00000000e+00,0.00000000e+00,4.80769231e-02,1.92307692e-01,9.61538462e-03,0.00000000e+00],
 [  0.00000000e+00,5.89041096e-01,6.84931507e-02,2.32876712e-01,0.00000000e+00,0.00000000e+00,8.21917808e-02,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,1.36986301e-02,1.36986301e-02,0.00000000e+00,0.00000000e+00],
 [  1.25195618e-02,3.05164319e-02,8.29420970e-01,8.45070423e-02,3.05164319e-02,0.00000000e+00,8.60719875e-03,2.34741784e-03,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,1.56494523e-03,0.00000000e+00,0.00000000e+00],
 [  9.81595092e-03,6.62576687e-02,8.58895706e-02,7.66871166e-01,1.96319018e-02,0.00000000e+00,3.31288344e-02,2.45398773e-03,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,2.45398773e-03,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,4.90797546e-03,8.58895706e-03,0.00000000e+00,0.00000000e+00],
 [  0.00000000e+00,2.70270270e-02,8.10810811e-02,1.08108108e-01,5.40540541e-01,0.00000000e+00,2.70270270e-02,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,2.70270270e-02,1.89189189e-01,0.00000000e+00,0.00000000e+00],
 [  4.93840861e-03,5.10487182e-03,8.32316058e-04,1.13749861e-02,6.10365109e-04,8.61502608e-01,1.12085229e-02,1.83109533e-03,1.60914438e-03,1.49816890e-03,0.00000000e+00,3.60670292e-03,1.27621796e-02,1.10975474e-04,2.10853401e-03,7.76828321e-04,4.43901898e-04,2.77438686e-04,3.93962934e-03,2.20286317e-02,5.21029852e-02,1.33170569e-03],
 [  3.92156863e-02,0.00000000e+00,0.00000000e+00,0.00000000e+00,1.96078431e-02,0.00000000e+00,8.52941176e-01,1.96078431e-02,0.00000000e+00,0.00000000e+00,9.80392157e-03,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,9.80392157e-03,0.00000000e+00,4.90196078e-02,0.00000000e+00,0.00000000e+00],
 [  0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,1.09890110e-02,3.29670330e-02,9.23076923e-01,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,3.29670330e-02,0.00000000e+00,0.00000000e+00,0.00000000e+00],
 [  5.00000000e-02,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,3.00000000e-01,0.00000000e+00,0.00000000e+00,5.50000000e-01,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,1.00000000e-01,0.00000000e+00],
 [  0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,7.77777778e-01,2.22222222e-01,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00],
 [  0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,5.00000000e-01,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,5.00000000e-01,0.00000000e+00,0.00000000e+00,0.00000000e+00],
 [  0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,4.54545455e-01,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,2.72727273e-01,0.00000000e+00,0.00000000e+00,0.00000000e+00,9.09090909e-02,0.00000000e+00,0.00000000e+00,9.09090909e-02,9.09090909e-02,0.00000000e+00,0.00000000e+00],
 [  4.87804878e-02,0.00000000e+00,0.00000000e+00,9.75609756e-02,0.00000000e+00,2.43902439e-01,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,4.39024390e-01,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,1.21951220e-01,4.87804878e-02,0.00000000e+00],
 [  0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,3.33333333e-01,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,3.33333333e-01,0.00000000e+00,0.00000000e+00,0.00000000e+00,3.33333333e-01,0.00000000e+00,0.00000000e+00,0.00000000e+00],
 [  9.52380952e-02,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,3.33333333e-01,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,1.90476190e-01,0.00000000e+00,3.33333333e-01,4.76190476e-02,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00],
 [  0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,1.11111111e-01,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,2.22222222e-01,1.11111111e-01,0.00000000e+00,4.44444444e-01,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,1.11111111e-01,0.00000000e+00,0.00000000e+00],
 [  2.50000000e-01,0.00000000e+00,0.00000000e+00,2.50000000e-01,0.00000000e+00,5.00000000e-01,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00],
 [  0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,3.33333333e-01,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,3.33333333e-01,0.00000000e+00,3.33333333e-01,0.00000000e+00,0.00000000e+00],
 [  1.31578947e-02,0.00000000e+00,0.00000000e+00,0.00000000e+00,1.31578947e-02,1.31578947e-02,2.63157895e-02,2.63157895e-02,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,3.94736842e-02,1.31578947e-02,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,5.39473684e-01,3.15789474e-01,0.00000000e+00,0.00000000e+00],
 [  6.06060606e-02,3.24675325e-02,8.65800866e-03,6.49350649e-02,4.32900433e-03,1.51515152e-02,7.35930736e-02,3.03030303e-02,1.73160173e-02,0.00000000e+00,0.00000000e+00,1.08225108e-02,4.32900433e-03,0.00000000e+00,0.00000000e+00,4.32900433e-03,2.16450216e-03,2.16450216e-03,9.52380952e-02,5.73593074e-01,0.00000000e+00,0.00000000e+00],
 [  0.00000000e+00,4.28112736e-03,0.00000000e+00,7.84873350e-03,0.00000000e+00,6.56439529e-02,1.42704245e-03,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,3.56760614e-04,5.70816982e-03,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,3.56760614e-04,1.42704245e-03,9.12236889e-01,7.13521227e-04],
 [  0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,1.00000000e-01,0.00000000e+00,0.00000000e+00,1.00000000e-01,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,8.00000000e-01]]
)
cm = np.array(
 [[  7.69230769e-02,2.88461538e-02,9.61538462e-03,5.76923077e-02,5.76923077e-02,1.92307692e-02,1.25000000e-01,7.69230769e-02,0.00000000e+00,1.92307692e-02,1.05769231e-01,1.92307692e-02,7.69230769e-02,0.00000000e+00,1.92307692e-02,9.61538462e-03,1.92307692e-02,1.92307692e-02,1.25000000e-01,3.84615385e-02,6.73076923e-02,2.88461538e-02],
 [  4.10958904e-02,2.46575342e-01,1.50684932e-01,1.23287671e-01,4.10958904e-02,4.10958904e-02,1.36986301e-02,1.36986301e-02,0.00000000e+00,4.10958904e-02,0.00000000e+00,1.36986301e-02,4.10958904e-02,0.00000000e+00,0.00000000e+00,0.00000000e+00,1.36986301e-02,0.00000000e+00,8.21917808e-02,1.09589041e-01,0.00000000e+00,2.73972603e-02],
 [  1.17370892e-02,2.34741784e-02,6.09546166e-01,1.51799687e-01,5.16431925e-02,8.60719875e-03,8.60719875e-03,2.11267606e-02,4.69483568e-03,2.34741784e-03,7.82472613e-04,9.38967136e-03,5.47730829e-03,1.56494523e-03,1.40845070e-02,1.56494523e-03,4.69483568e-03,1.56494523e-03,1.17370892e-02,2.73865415e-02,2.19092332e-02,6.25978091e-03],
 [  2.82208589e-02,4.41717791e-02,1.80368098e-01,4.02453988e-01,4.29447853e-02,2.69938650e-02,2.20858896e-02,4.78527607e-02,3.68098160e-03,7.36196319e-03,1.47239264e-02,1.96319018e-02,2.57668712e-02,7.36196319e-03,2.20858896e-02,4.90797546e-03,6.13496933e-03,3.68098160e-03,1.34969325e-02,4.53987730e-02,2.20858896e-02,8.58895706e-03],
 [  8.10810811e-02,8.10810811e-02,8.10810811e-02,5.40540541e-02,1.08108108e-01,0.00000000e+00,5.40540541e-02,8.10810811e-02,0.00000000e+00,5.40540541e-02,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,2.70270270e-02,0.00000000e+00,0.00000000e+00,1.08108108e-01,2.70270270e-02,1.62162162e-01,8.10810811e-02],
 [  5.29603476e-02,6.87126562e-02,4.23682781e-02,1.17870722e-01,4.86148832e-02,4.23682781e-02,9.53286257e-02,1.00488865e-01,2.03693645e-02,2.63443781e-02,2.71591526e-02,2.36284628e-02,3.74796306e-02,1.16784356e-02,4.12819120e-02,1.30363933e-02,1.33079848e-02,9.23411190e-03,5.37751222e-02,6.76262901e-02,6.46387833e-02,2.17273221e-02],
 [  8.82352941e-02,9.80392157e-03,0.00000000e+00,0.00000000e+00,4.90196078e-02,0.00000000e+00,3.62745098e-01,2.94117647e-02,1.96078431e-02,1.96078431e-02,9.80392157e-02,2.94117647e-02,9.80392157e-03,0.00000000e+00,1.96078431e-02,0.00000000e+00,0.00000000e+00,9.80392157e-03,1.96078431e-02,0.00000000e+00,2.35294118e-01,0.00000000e+00],
 [  1.09890110e-02,0.00000000e+00,0.00000000e+00,0.00000000e+00,1.09890110e-02,0.00000000e+00,5.49450549e-02,8.35164835e-01,3.29670330e-02,2.19780220e-02,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,1.09890110e-02,0.00000000e+00,2.19780220e-02,0.00000000e+00],
 [  0.00000000e+00,5.00000000e-02,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,5.00000000e-02,6.50000000e-01,0.00000000e+00,0.00000000e+00,0.00000000e+00,5.00000000e-02,5.00000000e-02,0.00000000e+00,0.00000000e+00,5.00000000e-02,0.00000000e+00,0.00000000e+00,5.00000000e-02,0.00000000e+00,0.00000000e+00,5.00000000e-02],
 [  0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,1.11111111e-01,0.00000000e+00,0.00000000e+00,0.00000000e+00,2.22222222e-01,2.22222222e-01,2.22222222e-01,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,1.11111111e-01,0.00000000e+00,1.11111111e-01,0.00000000e+00],
 [  0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,5.00000000e-01,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,5.00000000e-01,0.00000000e+00],
 [  0.00000000e+00,0.00000000e+00,0.00000000e+00,9.09090909e-02,0.00000000e+00,0.00000000e+00,1.81818182e-01,0.00000000e+00,0.00000000e+00,1.81818182e-01,1.81818182e-01,0.00000000e+00,0.00000000e+00,0.00000000e+00,9.09090909e-02,1.81818182e-01,0.00000000e+00,0.00000000e+00,0.00000000e+00,9.09090909e-02,0.00000000e+00,0.00000000e+00],
 [  7.31707317e-02,9.75609756e-02,0.00000000e+00,4.87804878e-02,2.43902439e-02,0.00000000e+00,7.31707317e-02,4.87804878e-02,2.43902439e-02,4.87804878e-02,0.00000000e+00,0.00000000e+00,2.43902439e-02,2.43902439e-02,7.31707317e-02,9.75609756e-02,0.00000000e+00,2.43902439e-02,9.75609756e-02,9.75609756e-02,4.87804878e-02,7.31707317e-02],
 [  0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,3.33333333e-01,3.33333333e-01,0.00000000e+00,0.00000000e+00,0.00000000e+00,3.33333333e-01,0.00000000e+00,0.00000000e+00],
 [  0.00000000e+00,0.00000000e+00,0.00000000e+00,4.76190476e-02,9.52380952e-02,4.76190476e-02,0.00000000e+00,0.00000000e+00,4.76190476e-02,0.00000000e+00,0.00000000e+00,9.52380952e-02,1.42857143e-01,0.00000000e+00,9.52380952e-02,4.76190476e-02,4.76190476e-02,0.00000000e+00,9.52380952e-02,1.90476190e-01,0.00000000e+00,4.76190476e-02],
 [  0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,1.11111111e-01,1.11111111e-01,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,1.11111111e-01,1.11111111e-01,2.22222222e-01,0.00000000e+00,1.11111111e-01,0.00000000e+00,0.00000000e+00,1.11111111e-01,0.00000000e+00,1.11111111e-01,0.00000000e+00],
 [  0.00000000e+00,2.50000000e-01,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,2.50000000e-01,0.00000000e+00,2.50000000e-01,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,2.50000000e-01,0.00000000e+00,0.00000000e+00],
 [  0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,3.33333333e-01,0.00000000e+00,3.33333333e-01,3.33333333e-01],
 [  3.94736842e-02,5.26315789e-02,0.00000000e+00,0.00000000e+00,5.26315789e-02,0.00000000e+00,9.21052632e-02,1.31578947e-02,5.26315789e-02,1.31578947e-02,3.94736842e-02,1.31578947e-02,5.26315789e-02,0.00000000e+00,5.26315789e-02,1.31578947e-02,3.94736842e-02,2.63157895e-02,3.02631579e-01,6.57894737e-02,7.89473684e-02,0.00000000e+00],
 [  7.14285714e-02,6.27705628e-02,3.24675325e-02,1.01731602e-01,2.59740260e-02,2.38095238e-02,8.87445887e-02,6.06060606e-02,8.65800866e-03,2.38095238e-02,2.81385281e-02,2.81385281e-02,5.19480519e-02,6.49350649e-03,4.32900433e-02,1.51515152e-02,1.29870130e-02,8.65800866e-03,1.23376623e-01,1.19047619e-01,3.89610390e-02,2.38095238e-02],
 [  5.10167677e-02,9.63253657e-03,3.56760614e-03,3.21084552e-03,6.77845166e-02,3.21084552e-03,1.15233678e-01,1.60542276e-02,5.35140920e-03,1.89083125e-02,3.42490189e-02,1.21298609e-02,1.56974670e-02,8.56225473e-03,1.07028184e-02,1.17731002e-02,1.42704245e-03,2.49732430e-02,2.03353550e-02,9.63253657e-03,5.46914021e-01,9.63253657e-03],
 [  1.00000000e-01,0.00000000e+00,0.00000000e+00,0.000000000.2e+00,2.00000000e-01,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,1.00000000e-01,0.00000000e+00,1.00000000e-01,0.00000000e+00,5.00000000e-01]]  )
 
cm = np.array([[ 0.15384615,0.05769231,0.00961538,0.05769231,0.06730769,0.,0.18269231,0.07692308,0.08653846,0.02884615,0.125,0.05769231,0.06730769,0.02884615],
 [ 0.02739726,0.21917808,0.15068493,0.12328767,0.05479452,0.02739726,0.01369863,0.01369863,0.06849315,0.02739726,0.10958904,0.1369863,0.01369863,0.01369863],
 [ 0.01408451,0.02503912,0.60641628,0.15258216,0.05399061,0.01017214,0.01095462,0.01799687,0.01251956,0.01877934,0.0172144,0.02895149,0.02269171,0.0086072 ],
 [ 0.04417178,0.04662577,0.17055215,0.43435583,0.04417178,0.02944785,0.02699387,0.04539877,0.0392638,0.03067485,0.02331288,0.03558282,0.02208589,0.00736196],
 [ 0.05405405,0.10810811,0.05405405,0.05405405,0.10810811,0.,0.10810811,0.13513514,0.,0.05405405,0.10810811,0.02702703,0.10810811,0.08108108],
 [ 0.07873354,0.06836649,0.0442701,0.12776688,0.04763239,0.04875315,0.1213225,0.09666573,0.06108154,0.06052115,0.07004763,0.07312973,0.0708882,0.03082096],
 [ 0.17647059,0.,0.,0.,0.07843137,0.,0.37254902,0.03921569,0.03921569,0.00980392,0.02941176,0.,0.24509804,0.00980392],
 [ 0.03759398,0.01503759,0.,0.0075188,0.03007519,0.0075188,0.08270677,0.66917293,0.03759398,0.02255639,0.03759398,0.0075188,0.03007519,0.01503759],
 [ 0.09756098,0.12195122,0.,0.07317073,0.02439024,0.04878049,0.07317073,0.04878049,0.07317073,0.12195122,0.07317073,0.09756098,0.04878049,0.09756098],
 [ 0.,0.02702703,0.,0.02702703,0.10810811,0.02702703,0.,0.02702703,0.13513514,0.27027027,0.13513514,0.13513514,0.02702703,0.08108108],
 [ 0.07594937,0.05063291,0.,0.,0.02531646,0.03797468,0.11392405,0.06329114,0.03797468,0.05063291,0.35443038,0.08860759,0.08860759,0.01265823],
 [ 0.0974026,0.06277056,0.03030303,0.11038961,0.03896104,0.03246753,0.11038961,0.05627706,0.06926407,0.05627706,0.12770563,0.12987013,0.04329004,0.03463203],
 [ 0.07991438,0.01248662,0.00392437,0.00214056,0.07420621,0.00713521,0.1412772,0.01712451,0.0217624,0.02033535,0.03781663,0.01034606,0.55654656,0.01498395],
 [ 0.1,0.,0.,0.,0.2,0.,0.,0.,0.,0.1,0.,0.1,0.,0.5       ]])

cm = np.array(
[[ 0.14423077,0.04807692,0.08653846,0.23076923,0.14423077,0.20192308,0.14423077],
 [ 0.03495234,0.66908761,0.09078529,0.03177485,0.04539265,0.07852928,0.04947798],
 [ 0.08854021,0.13589241,0.20005604,0.15830765,0.14569908,0.1745587,0.09694592],
 [ 0.18627451,0.01960784,0.00980392,0.38235294,0.06862745,0.02941176,0.30392157],
 [ 0.06321839,0.,0.08045977,0.12068966,0.5862069,0.10344828,0.04597701],
 [ 0.11591696,0.08477509,0.1384083,0.1349481,0.09515571,0.35986159,0.07093426],
 [ 0.08496267,0.00959829,0.0373267,0.17525773,0.03412727,0.03661571,0.62211162]]
) ; 

cm_squared = cm*cm
G = nx.from_numpy_matrix(cm) 
G = nx.relabel_nodes(G,mapping=dict(zip(G.nodes(),labels)))
   
nx.draw(G,edge_color = [ i[2]['weight'] for i in G.edges(data=True) ], edge_cmap=cmap.get_cmap('ocean') 
, width=2,style ='dashed',font_size=14,font_weight=1000,pos=nx.spring_layout(G) ) 



pos = nx.spectral_layout(G, dim=2, weight='weight', scale=1) ; 
  
pos_xyz = np.zeros([len(labels),2],dtype = float);   
for j in  range(0, len(labels) ): 
    pos_xyz[j] = np.asarray(pos[labels[j]])

from sklearn.cluster import MeanShift, estimate_bandwidth
bandwidth = estimate_bandwidth(pos_xyz, quantile=0.2, n_samples=500)
ms = MeanShift(bandwidth=bandwidth, bin_seeding=True)
ms.fit(pos_xyz)
cluster_number = ms.labels_

from sklearn.cluster import AffinityPropagation
af = AffinityPropagation(damping=0.9,max_iter=10000,convergence_iter=150,affinity='euclidean').fit(pos_xyz ) 
af.
cluster_number = af.labels_ 
cluster_centers_indices = af.cluster_centers_indices_ 
n_clusters_ = len(cluster_centers_indices)
cluster_number = af.labels_

labels_pos = []
for i in range(0, len(labels)):
    labels_pos.append([labels[i],i])
dict_l_p = dict(labels_pos)  

edgewidth = [ d['weight']*15 for (u,v,d) in G.edges(data=True)]  
nx.draw_spectral(G,node_color=[ cluster_number[dict_l_p[i[0]]] for i in G.nodes(data=True) ],edge_color = [ i[2]['weight'] for i in G.edges(data=True) ], edge_cmap=cmap.get_cmap('jet') 
, width=edgewidth  ,font_size=10,font_weight='bold',font_family='' ) 
 
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D
fig = plt.figure()
ax = fig.add_subplot(111, projection='3d')
for i in range(0,len(labels)) :
    ax.text(pos_xyz[i ,0].tolist(), pos_xyz[i ,1].tolist(), pos_xyz[i ,0].tolist(), labels[i] )
ax.set_xlim3d(0, 1)
ax.set_ylim3d(0, 1)
ax.set_zlim3d(0, 1) 
ax.text(1, 1,1, "toto" ,'x')
fig.show()



from mpl_toolkits.mplot3d import Axes3D
import matplotlib.pyplot as plt


fig = plt.figure()
ax = fig.gca(projection='3d')

zdirs = (None, 'x', 'y', 'z', (1, 1, 0), (1, 1, 1))
xs = (1, 4, 4, 9, 4, 1)
ys = (2, 5, 8, 10, 1, 2)
zs = (10, 3, 8, 9, 1, 8)

for zdir, x, y, z in zip(zdirs, xs, ys, zs):
    label = '(%d, %d, %d), dir=%s' % (x, y, z, zdir)
    ax.text(x, y, z, label, zdir)

ax.text(9, 0, 0, "red", color='red')
ax.text2D(0.05, 0.95, "2D Text", transform=ax.transAxes)

ax.set_xlim3d(0, 10)
ax.set_ylim3d(0, 10)
ax.set_zlim3d(0, 10)

ax.set_xlabel('X axis')
ax.set_ylabel('Y axis')
ax.set_zlabel('Z axis')

plt.show()


from sklearn.cluster import AffinityPropagation
af = AffinityPropagation().fit(pos_xyz)
cluster_centers_indices = af.cluster_centers_indices_
labels = af.labels_

import shapely
from shapely.geometry import MultiPoint
from shapely.geometry import asMultiPoint


cluster_number
mps = [] ;
for i in range(0,n_clusters_): 
    mps.append(asMultiPoint(pos_xyz[cluster_number==i]))

bb_mps = []    
for i in range(0,n_clusters_): 
    bb_mps.append(
    mps[i].buffer(1.0).buffer(-0.95)    
    )

 
from matplotlib.patches import Polygon  
polygons = bb_mps;  
a_colour_map = cmap.get_cmap('jet') 
fig, ax = plt.subplots(figsize=(8, 8))
for i,(polygon) in enumerate(polygons):
    mpl_poly = Polygon(np.array(polygon.exterior) ,   lw=0, alpha=0.4)
    ax.add_patch(mpl_poly) 
ax.relim()
ax.autoscale()